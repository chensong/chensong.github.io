---
layout: post
title: Rancher1.6 traefik CVE-2016-2183
categories: [Blog, rancher, traefik]
description: Rancher1.6 traefik CVE-2016-2183 漏洞
keywords: CVE-2016-2183
---

## 1. CVE-2016-2183 定义

```txt
64位块大小（如Triple-DES（3DES））的传统块密码在CBC模式下使用，易受到攻击。当使用CBC模式操作时，使用simple birthday attack来识别64位块密码冲突。当碰撞发生时，这意味着输入与输出相同，使得可以执行BEAST style attack来渗透加密的数据。
```

## 2. 测试 SWEET32

* 确定服务器是否支持Triple-DES密码，如果服务器支持Triple-DES，则易受SWEET32攻击。
* 使用3DES的任何密码都易受SWEET32影响。

### 2.1 SWEET32 Nmap测试

Nmap也可用于枚举服务器的密码，NSE插件还将通知是否有任何64位块密码可用。

```sh
nmap --script = ssl-enum-ciphers -p443 TARGET
```

  如果您在输出中看到以下内容，则会发现64位块密码

```sh
warnings: 
    64-bit block cipher 3DES vulnerable to SWEET32 attack
```

## 3. Rancher1.6 traefik 修复方法

### 3.1 修改 traefik.toml

```sh
    [entryPoints.traefik.tls]
      MinVersion = "VersionTLS12"
      cipherSuites = [
        "TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256",
        "TLS_RSA_WITH_AES_128_GCM_SHA256",
        "TLS_RSA_WITH_AES_256_GCM_SHA384",
        "TLS_RSA_WITH_AES_128_CBC_SHA",
        "TLS_RSA_WITH_AES_256_CBC_SHA"
      ]
```

### 3.2 编辑 /opt/traefik/bin/traefik.toml.sh

```sh
    [entryPoints.traefik.tls]
      MinVersion = \"${TRAEFIK_HTTPS_MIN_TLS}\"
      cipherSuites = [
        \"TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256\",
        \"TLS_RSA_WITH_AES_128_GCM_SHA256\",
        \"TLS_RSA_WITH_AES_256_GCM_SHA384\",
        \"TLS_RSA_WITH_AES_128_CBC_SHA\",
        \"TLS_RSA_WITH_AES_256_CBC_SHA\"
      ]
```

## 参考文章

* <https://www.bbsmax.com/A/q4zVbYVlzK/>
* <https://blog.csdn.net/weixin_30642267/article/details/98855813>
